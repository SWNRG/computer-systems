# Εργαστήριο 6 - Δικαιώματα πρόσβασης στα αρχεία και τους καταλόγους

## Περιεχόμενα μαθήματος

- [Δικαιώματα αρχείων και καταλόγων](#δικαιώματα-αρχείων-και-καταλόγων)

## Δικαιώματα αρχείων και καταλόγων

Στο μάθημα θα εξετάσουμε τα δικαιώματα αρχείων και καταλόγων στο Linux. Το σύστημα δικαιωμάτων ελέγχει ποιος έχει πρόσβαση σε κάθε αρχείο ή κατάλογο και ποιες ενέργειες επιτρέπονται. Για να διαχειριστούμε τα δικαιώματα αυτά, χρησιμοποιούμε την εντολή `chmod`.

### Δικαιώματα αρχείων και καταλόγων
Κάθε αρχείο ή κατάλογος στο Linux έχει τρία βασικά δικαιώματα:

Ανάγνωση (Read - r): Επιτρέπει την ανάγνωση του περιεχομένου του αρχείου ή του καταλόγου. Για παράδειγμα, μπορούμε να εμφανίσουμε το περιεχόμενο του αρχείου με την εντολή `cat` ή να εμφανίσουμε τα ονόματα των αρχείων που περιέχει ο κατάλογος με την εντολή `ls`.
Εγγραφή (Write - w): Επιτρέπει την επεξεργασία ή την εγγραφή στο αρχείο ή τον κατάλογο. Δηλαδή, επιτρέπεται να μεταβάλουμε το περιεχόμενο ενός αρχείου (π.χ. μέσω του επεξεργαστή κειμένου `nano`) ή να προσθέσουμε νέα αρχεία σε έναν κατάλογο.
Εκτέλεση (Execute - x): Επιτρέπει την εκτέλεση του αρχείου ή την πρόσβαση στον κατάλογο. Για παράδειγμα, μπορούμε να εκτελέσουμε ένα πρόγραμμα ή να μπούμε σε έναν κατάλογο με την εντολή `ls`.

Τα δικαιώματα αυτά ορίζονται για τρια διαφορετικά επίπεδα πρόσβασης:

Κάτοχος (Owner): Ο χρήστης που δημιούργησε το αρχείο ή τον κατάλογο.
Ομάδα (Group): Η ομάδα στην οποία ανήκει το αρχείο ή ο κατάλογος.
Άλλοι (Others): Όλοι οι υπόλοιποι χρήστες στο σύστημα.

Για να εμφανίσουμε τα δικαιώματα των αρχείων, χρησιμοποιούμε την εντολή `ls` με την παράμετρο `-l`:

```console
stud@vm2:~$ ls -l info
-rw-rw-r-- 1 stud stud 23 Nov  2  2022 info
```

Δηλαδή, ο ιδιοκτήτης του αρχείου (stud) έχει δικαίωμα ανάγνωσης και εγγραφής στο αρχείο info, η ομάδα που ανήκει το αρχείο (stud) έχει τα ίδια δικαιώματα, ενώ οι υπόλοιποι χρήστες μπορούν μόνο να διαβάσουν το αρχείο.

Ας δούμε τώρα ένα παράδειγμα δικαιωμάτων πρόσβασης σε κατάλογο.

```console
stud@vm2:~$ ls -l | grep secdir
drwxr-x--- 2 stud stud  4096 Oct 27  2022 secdir
```

Δηλαδή, ο χρήστης stud έχει δικαίωμα να μπει στον κατάλογο (δικαίωμα x), να δεί τα αρχεία που περιέχει (δικαίωμα r), αλλά και να αφαιρέσει ή να προσθέσει νέα αρχεία ή υποκαταλόγους στον κατάλογο secdir (δικαίωμα w). Αντίστοιχα, τα μέλη της ομάδας stud μπορούν μόνο να μπουν και να δουν τα αρχεία του καταλόγου. Οι υπόλοιποι χρήστες του συστήματος δεν έχουν κανένα ενεργοποιημένο δικαίωμα πρόσβασης στον κατάλογο.

### Καθορισμός των δικαιωμάτων στα αρχεία και τους καταλόγους
Η εντολή `chmod` ορίζει τα δικαιώματα πρόσβασης σε ένα αρχείο ή κατάλογο. Ένας χρήστης μπορεί να μεταβάλλει τα δικαιώματα μόνο των αρχείων που είναι ιδιοκτήτης, π.χ. τα αρχεία στον προσωπικό του κατάλογο.

Η `chmod` μπορεί να χρησιμοποιηθεί με δύο διαφορετικούς τρόπους: το σύστημα ugo (user, group, others) και τον αριθμητικό τρόπο.

Στο σύστημα ugo χρησιμοποιούμε τρία γράμματα (u, g, o) για κάθε κατηγορία (user, group, others), τον χαρακτήρα + στην περίπτωση ενεργοποίησης των δικαιωμάτων ή τον χαρακτήρα - στην περίπτωση απενεργοποίησης και στη συνέχεια προσθέτουμε τα δικαιώματα που θέλουμε να ενεργοποιήσουμε ή να απενεργοποιήσουμε (r, w, x).

Έτσι, για παράδειγμα, η εντολή `chmod u+r file` προσθέτει το δικαίωμα ανάγνωσης στον κάτοχο του αρχείου `file`:

```console
stud@vm2:~$ ls -l file
---------- 1 stud stud 0 Dec 13 17:07 file
stud@vm2:~$ chmod u+r file
stud@vm2:~$ ls -l file
-r-------- 1 stud stud 0 Dec 13 17:07 file
```

Εαν αντί για u, g ή o χρησιμοποιήσουμε τον χαρακτήρα a (all), τα δικαιώματα εφαρμόζονται για όλους του χρήστες. Το ίδιο αποτέλεσμα θα έχουμε εαν παραβλέψουμε εντελώς την δήλωση του επιπέδου πρόσβασης. Για παράδειγμα:

```console
stud@vm2:~$ chmod a+x file
stud@vm2:~$ ls -l file
-r-x--x--x 1 stud stud 0 Dec 13 17:07 file
stud@vm2:~$ chmod -x file
stud@vm2:~$ ls -l file
-r-------- 1 stud stud 0 Dec 13 17:07 file
```

Στον αριθμητικό τρόπο χρησιμοποιούμε έναn τριψήφιο αριθμητικό κωδικό για να αντιστοιχίσουμε συγκεκριμένα δικαιώματα. Κάθε ψηφίο στον κωδικό αντιπροσωπεύει μια κατηγορία (user, group, others).

Το πρώτο ψηφίο αντιστοιχεί στον κάτοχο (user), το δεύτερο στην ομάδα (group), και το τρίτο στους άλλους (others). Τα δικαιώματα αναγνώσης, εγγραφής και εκτέλεσης αντιστοιχούν στις τιμές 4, 2 και 1, αντίστοιχα.

Έτσι, για παράδειγμα, η εντολή `chmod 764 file` θα έδινε τα εξής δικαιώματα:

Κάτοχος: read+write+execute (4+2+1 = 7).
Ομάδα: read+write (4+2 = 6).
Άλλοι: read (4).

Ας δούμε μερικά παραδείγματα.

```console
stud@vm2:~$ chmod 764 file
stud@vm2:~$ ls -l file
-rwxrw-r-- 1 stud stud 0 Dec 13 17:07 file
stud@vm2:~$ chmod 000 file
stud@vm2:~$ ls -l file
---------- 1 stud stud 0 Dec 13 17:07 file
stud@vm2:~$ chmod 740 file
-rwxr----- 1 stud stud 0 Dec 13 17:07 file
```

Παρατηρούμε ότι στο σύστημα ugo μπορούμε να ανοίξουμε ή να κλείσουμε επιλεκτικά κάποιο δικαίωμα, ενώ στον αριθμητικό τρόπο ορίζουμε όλα τα δικαιώματα μαζί.
