# Εργαστήριο 4 - Κανάλια εισόδου - εξόδου

## Περιεχόμενα μαθήματος

- [Κανάλια εισόδου - εξόδου](#κανάλια-εισόδου---εξόδου)

## Κανάλια εισόδου - εξόδου
[![asciicast](https://asciinema.org/a/RuY67HOSBDa6H6ssDXale3VJb.svg)](https://asciinema.org/a/RuY67HOSBDa6H6ssDXale3VJb)

Τα προγράμματα στο Linux, όπως οι εντολές στη γραμμή εντολών, υποστηρίζουν τρεις τρόπους επικοινωνίας με το λειτουργικό σύστημα ή άλλα προγράμματα:
1. *Κανάλι εισόδου (stdin channel)*: επιτρέπει σε ένα πρόγραμμα να λαμβάνει δεδομένα από τον χρήστη ή από άλλες πηγές. Τα δεδομένα εισόδου μπορεί να προέρχονται από το πληκτρολόγιο, από αρχεία, από δικτυακές συνδέσεις ή άλλες πηγές.
2. *Κανάλι εξόδου (stdout channel)*: επιτρέπει σε ένα πρόγραμμα να στέλνει πληροφορίες ή αποτελέσματα πίσω στο χρήστη ή σε άλλες εφαρμογές. Τα δεδομένα εξόδου μπορεί να προβάλλονται στην οθόνη, να αποθηκεύονται σε αρχεία ή να διαβιβάζονται μέσω δικτύου.
3. *Κανάλι σφαλμάτων (stderr channel)*: χρησιμοποιείται για την αναφορά σφαλμάτων που προκύπτουν κατά την εκτέλεση ενός προγράμματος. Όταν κάτι πάει λάθος, το πρόγραμμα μπορεί να στείλει μηνύματα σφάλματος στον κανάλι stderr, αντί αυτά να εμφανίζονται στην οθόνη μέσω του καναλιού εξόδου (stdout).

Για παράδειγμα, εαν εκτελέσουμε την εντολή `cat`:

```console
stud@vm2:~$ cat filename 
hello.
```

Η είσοδος της εντολής `cat` είναι το περιεχόμενο του αρχείου `filename`. 

Κοιτώντας το manual της εντολής `cat`, παρατηρούμε ότι αναφέρει στην περιγραφή της εντολής:

```console
stud@vm2:~$ man cat
...
 DESCRIPTION
        Concatenate FILE(s) to standard output.

        With no FILE, or when FILE is -, read standard input.
...
```

Δηλαδή, στην περίπτωση που δεν δηλώσουμε κάποιο αρχείο στα ορίσματα της `cat`, η εντολή λαμβάνει είσοδο από το `stdin`.

Εαν τρέξουμε την `cat` χωρίς κανένα όρισμα, η γραμμή εντολών περιμένει να εισάγουμε το κείμενο - είσοδο της `cat` από το πληκτρολόγιο. Έτσι, παύει να εμφανίζεται η προτροπή (prompt) της γραμμής εντολών και μπορούμε να εισάγουμε ελεύθερο κείμενο.

Στη συνέχεια έχουμε δύο επιλογές, είτε να ολοκληρώσουμε την είσοδο της `cat` πατώντας `ctrl+d`, είτε να ακυρώσουμε την εκτέλεση της με `ctrl+c`.

```console
stud@vm2:~$ cat
orange
orange
apple
apple
<ctrl+d>
```

Δηλαδή, η `cat` εμφανίζει ανά σειρά ότι της δίνουμε σαν είσοδο.

Για να γίνει περισσότερο κατανοητό το κανάλι εισόδου, μπορούμε να δοκιμάσουμε την εντολή `sort`, η οποία ταξινομεί τα δεδομένα που λαμβάνει μέσω του καναλιού εισόδου:

```console
stud@vm2:~$ cat fruits 
banana
orange
apple
apricot
stud@vm2:~$ sort fruits 
apple
apricot
banana
orange
```

Στην περίπτωση που εκτελέσουμε την `sort` χωρίς καμία παράμετρο, θα πρέπει να εισάγουμε το κείμενο από το πληκτρολόγιο.

```console
stud@vm2:~$ sort
banana
orange
apple
apricot
<ctrl+d>
apple
apricot
banana
orange
```

Δηλαδή, μετά το `ctrl+d` (ολοκλήρωση εισόδου), η `sort` εμφανίζει αυτά που γράψαμε, ταξινομημένα.

Στην περίπτωση που πατήσουμε `ctrl+c`, η εκτέλεση της εντολής ακυρώνεται και δεν προκύπτει κάποια έξοδος.

Σε σχέση με το κανάλι εξόδου (stdout), αυτό συνδέεται συνήθως με την οθόνη. Στην πραγματικότητα, οι τελεστές `>` ή `>>`, συνδέουν το κανάλι εξόδου με ένα αρχείο. Π.χ.:

```console
stud@vm2:~$ sort fruits > sorted_fruits
stud@vm2:~$ cat sorted_fruits 
apple
apricot
banana
orange
```

Δηλαδή, τα ταξινομημένα φρούτα αντι να εμφανιστούν στην οθόνη, τοποθετήθηκαν σε ένα αρχείο.

Το κανάλι σφαλμάτων (stderr) έχει παρόμοια λειτουργία με το stdout. Π.χ.:

```console
stud@vm2:~$ ls ---
ls: unrecognized option '---'
Try 'ls --help' for more information.
```
(δεν υπάρχει αποδεκτή παράμετρος `---`)

Μπορούμε να ανακατευθύνουμε το σφάλμα σε ένα αρχείο:

```console
stud@vm2:~$ ls --- 2> ls_error
stud@vm2:~$ cat ls_error 
ls: unrecognized option '---'
Try 'ls --help' for more information.
```

Δηλαδή αντι να εμφανιστεί το σφάλμα στην οθόνη, καταγράφηκε σε ένα αρχείο. Εδώ σημειώνουμε ότι ο τελεστής ανακατεύθυνσης του καναλιού σφαλμάτων είναι ο `2>`.

Ένας ακόμη πολύ χρήσιμος τελεστής είναι ο τελεστής διασωλήνωσης `|`.

Ο χαρακτήρας `|` μας επιτρέπει να συνδέσουμε την έξοδο (stdout) μιας εντολής με την είσοδο μιας άλλης. Π.χ.:

```console
stud@vm2:~$ cat fruits | sort
apple
apricot
banana
orange
```

Στο παραπάνω παράδειγμα, το περιεχόμενο του αρχείου `fruits`, αντί να εμφανιστεί στην οθόνη, συνδέθηκε με το κανάλι εισόδου (stdin) της εντολής `sort`. 

Αυτό είχε σαν αποτέλεσμα να εμφανιστούν τα φρούτα ταξινομημένα.

Με τη βοήθεια της διασωλήνωσης μπορούμε να συνδυάσουμε εντολές του Linux, ώστε να υλοποιήσουμε πολύπλοκες λειτουργίες με εύκολο τρόπο.
